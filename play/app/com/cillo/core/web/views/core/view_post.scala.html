@(user: Option[User], post: Post)(poster: Option[User] = User.find(post.user_id),
        board: Option[Board] = Board.find(post.board_id),
        repost: Option[Post] = post.repost_id.flatMap(Post.find),
        media: Seq[Option[Media]] = post.media.map(m => Media.find(m)))

@import com.cillo.core.web.views.html.components
@import com.cillo.core.web.controllers.RemoteURLController
@import com.cillo.core.data.db.models._
@import com.cillo.utils.Etc

@components.base(if(post.title.isDefined){post.title.get}else{poster.get.name + "'s post on " + board.get.name}) {
    <style>
        .comment-children-container {
            border-top: 1px solid #e1e8ed;
        }
    </style>

    <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# cilloapp: http://ogp.me/ns/fb/cilloapp#">

    <meta property="og:url" content="https://www.cillo.co/@board.get.name/posts/@post.post_id.get" />
    <meta property="fb:app_id" content="911323222224791" />
    <meta property="og:type"   content="cilloapp:post" />
    <meta property="og:site_name" content="Cillo" />
    @if(!repost.isDefined) {
        @if(post.title.isDefined) {
            <meta property="og:title" content="@post.title.get" />
        } else {
            <meta property="og:title" content="@poster.get.name's post on @board.get.name" />
        }
        <meta property="og:description" content="@Etc.ellipsize(post.data, 300)">
    } else {
        @if(repost.get.title.isDefined) {
            <meta property="og:title" content="@repost.get.title.get" />
        } else {
            <meta property="og:title" content="@poster.get.name's post on @board.get.name" />
        }
        <meta property="og:description" content="@Etc.ellipsize(repost.get.data, 300)">
    }

} {
    <body class="single-post main-background@if(!user.isDefined){ logged-out}">
        <div class="page" style="margin:0px;">
            @components.masthead(user, searchBar = true)
            <div id="content">
                <div class="container-fluid inner-background" style="width: 900px;">
                    <div class="main-row" style="padding: 20px;">
                        @components.post(post, user)(expanded = true, board = board.get, poster = poster.get, repost = repost)
                    </div>
                </div>
            </div>
        </div>

        @if(user.isDefined) {
            @components.repost_modal(User.getBoards(user.get.user_id.get))
        } else {
            @components.logged_out()
        }
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
        <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        @Html(RemoteURLController.js)

        @components.fb_init()

    </body>
}