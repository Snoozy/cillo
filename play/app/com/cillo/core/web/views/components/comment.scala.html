@(commentTreeNode: CommentTreeNode, user: Option[User])(expanded: Boolean = false,
        vote: Option[CommentVote] = user.flatMap{u => CommentVote.findByCommentAndUser(commentTreeNode.comment.comment_id.get, u.user_id.get)},
        commenter: User = User.find(commentTreeNode.comment.user_id).get,
        root: Boolean = false,
        anon: Boolean = false,
        anonImg: String = "https://static.cillo.co/image/anon")

@import com.cillo.utils.Etc
@import com.cillo.core.web.views.html.components

<div class="@if(root){root-comment }comment-container">
    <div class="comment" data-comment-id="@commentTreeNode.comment.comment_id.get" data-post-id="@commentTreeNode.comment.post_id">
        @if(!anon) {
            <div class="comment-avatar">
                <a href="/user/@commenter.username">
                    <img src="@(commenter.photo + "_small")" class="avatar" style="height:32px;width:32px;border-radius:3px;"/>
                </a>
            </div>
            <a href="/user/@commenter.username" style="margin-right:2px;margin-left:5px;">
                <strong style="font-weight:500;">@commenter.name</strong>
            </a>
        } else {
            <div class="comment-avatar">
                <img src="@(anonImg + "_small")" class="avatar" style="height:32px;width:32px;border-radius:3px;"/>
            </div>
            <strong style="font-weight:500;margin-right:2px;margin-left:5px;" class="anonymous-user">Anonymous</strong>
        }
        ·
        <span class="comment-timestamp">
            @Etc.convertEpochToTimestamp(commentTreeNode.comment.time)
        </span>
        <p class="comment-content">
            @Html(Etc.parseHTML(commentTreeNode.comment.data))
        </p>
        <div class="comment-actions">
            <span class="like-count" style="margin: 0px;">
                @commentTreeNode.comment.votes
            </span>
            ·
            <a href="#" class="c-action no-dec like@if(vote.isDefined && vote.get.value == 1){ liked}">
                <i class="icon-upvote"></i>
            </a>

            <span style="color:#ccc"> | </span>

            <a href="#" class="c-action no-dec dislike@if(vote.isDefined && vote.get.value == -1){ disliked}" style="margin-left:-2px;margin-right:-2px;">
                <i class="icon-downvote"></i>
            </a>
            ·
            <a href="#" class="c-action reply">
                <span class="color-blue">Reply</span>
            </a>
        </div>
            <div class="comment-children-container">
                @if(expanded) {
                    @for(child <- commentTreeNode.children) {
                        @components.comment(child, user)(expanded = expanded, anon = anon)
                    }
                }
            </div>
    </div>
</div>